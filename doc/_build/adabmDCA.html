<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>adabmDCA package &#8212; adabmDCApy 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="adabmDCApy documentation" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="adabmdca-package">
<h1>adabmDCA package<a class="headerlink" href="#adabmdca-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-adabmDCA.custom_fn">
<span id="adabmdca-custom-fn-module"></span><h2>adabmDCA.custom_fn module<a class="headerlink" href="#module-adabmDCA.custom_fn" title="Link to this heading">¶</a></h2>
</section>
<section id="module-adabmDCA.dataset">
<span id="adabmdca-dataset-module"></span><h2>adabmDCA.dataset module<a class="headerlink" href="#module-adabmDCA.dataset" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="adabmDCA.dataset.DatasetDCA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">adabmDCA.dataset.</span></span><span class="sig-name descname"><span class="pre">DatasetDCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.dataset.DatasetDCA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="adabmDCA.dataset.DatasetDCA.get_effective_size">
<span class="sig-name descname"><span class="pre">get_effective_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#adabmDCA.dataset.DatasetDCA.get_effective_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="adabmDCA.dataset.DatasetDCA.get_num_residues">
<span class="sig-name descname"><span class="pre">get_num_residues</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#adabmDCA.dataset.DatasetDCA.get_num_residues" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="adabmDCA.dataset.DatasetDCA.get_num_states">
<span class="sig-name descname"><span class="pre">get_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#adabmDCA.dataset.DatasetDCA.get_num_states" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="adabmDCA.dataset.DatasetDCA.shuffle">
<span class="sig-name descname"><span class="pre">shuffle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#adabmDCA.dataset.DatasetDCA.shuffle" title="Link to this definition">¶</a></dt>
<dd><p>Shuffles the dataset.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-adabmDCA.fasta_utils">
<span id="adabmdca-fasta-utils-module"></span><h2>adabmDCA.fasta_utils module<a class="headerlink" href="#module-adabmDCA.fasta_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.compute_weights">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">compute_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.fasta_utils.compute_weights" title="Link to this definition">¶</a></dt>
<dd><p>Computes the weight to be assigned to each sequence ‘s’ in ‘data’ as 1 / n_clust, where ‘n_clust’ is the number of sequences
that have a sequence identity with ‘s’ &gt;= th.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em> | </em><em>torch.Tensor</em>) – Encoded input dataset.</p></li>
<li><p><strong>th</strong> (<em>float</em><em>, </em><em>optional</em>) – Sequence identity threshold for the clustering. Defaults to 0.8.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device. Defaults to “cpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the weights of the sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.decode_sequence">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">decode_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#adabmDCA.fasta_utils.decode_sequence" title="Link to this definition">¶</a></dt>
<dd><p>Takes a numeric sequence or list of seqences in input an returns the corresponding string encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<em>np.ndarray</em>) – Input sequences. Can be either a 1D or a 2D array.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – Alphabet to be used for the encoding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decoded input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.encode_sequence">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">encode_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#adabmDCA.fasta_utils.encode_sequence" title="Link to this definition">¶</a></dt>
<dd><p>Encodes a sequence or a list of sequences into a numeric format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Array</em><em>]</em>) – Input sequence.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – Alphabet to be used for the encoding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.get_tokens">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">get_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#adabmDCA.fasta_utils.get_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Converts the alphabet into the corresponding tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alphabet</strong> (<em>str</em>) – Alphabet to be used for the encoding. It can be either “protein”, “rna”, “dna” or a custom string of tokens.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tokens of the alphabet.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.import_clean_dataset">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">import_clean_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filein</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'protein'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.fasta_utils.import_clean_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Imports data from a fasta file and removes all the sequences whose tokens are not present in a specified alphabet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filein</strong> (<em>str</em>) – Input fasta.</p></li>
<li><p><strong>tokens</strong> (<em>str</em><em>, </em><em>optional</em>) – Alphabet to be used for the encoding. Defaults to “protein”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>headers, sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.import_from_fasta">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">import_from_fasta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fasta_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.fasta_utils.import_from_fasta" title="Link to this definition">¶</a></dt>
<dd><p>Import data from a fasta file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fasta_name</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to the fasta file.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – Alphabet to be used for the encoding. If provided, encodes the sequences in numeric format.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – The file is not in fasta format.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>headers, sequences.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.validate_alphabet">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">validate_alphabet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.fasta_utils.validate_alphabet" title="Link to this definition">¶</a></dt>
<dd><p>Check if the chosen alphabet is compatible with the input sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequences</strong> (<em>np.ndarray</em>) – Input sequences.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – Alphabet to be used for the encoding.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – The chosen alphabet is incompatible with the Multi-Sequence Alignment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.fasta_utils.write_fasta">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.fasta_utils.</span></span><span class="sig-name descname"><span class="pre">write_fasta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_gaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'protein'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.fasta_utils.write_fasta" title="Link to this definition">¶</a></dt>
<dd><p>Generate a fasta file with the input sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Name of the output fasta file.</p></li>
<li><p><strong>headers</strong> (<em>np.ndarray</em>) – Array of sequences’ headers.</p></li>
<li><p><strong>sequences</strong> (<em>np.ndarray</em>) – Array of sequences.</p></li>
<li><p><strong>numeric_input</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the sequences are in numeric (encoded) format or not. Defaults to False.</p></li>
<li><p><strong>remove_gaps</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, removes the gap from the alignment. Defaults to False.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – Alphabet to be used for the encoding. Defaults to protein.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-adabmDCA.grad">
<span id="adabmdca-grad-module"></span><h2>adabmDCA.grad module<a class="headerlink" href="#module-adabmDCA.grad" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.grad.train_graph">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.grad.</span></span><span class="sig-name descname"><span class="pre">train_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsweeps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_pearson</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.grad.train_graph" title="Link to this definition">¶</a></dt>
<dd><p>Trains the model on a given graph until the target Pearson correlation is reached or the maximum number of epochs is exceeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampler</strong> (<em>Callable</em>) – Sampling function.</p></li>
<li><p><strong>chains</strong> (<em>torch.Tensor</em>) – Markov chains simulated with the model.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em>) – Mask encoding the sparse graph.</p></li>
<li><p><strong>fi</strong> (<em>torch.Tensor</em>) – Single-point frequencies of the data.</p></li>
<li><p><strong>fij</strong> (<em>torch.Tensor</em>) – Two-point frequencies of the data.</p></li>
<li><p><strong>pi</strong> (<em>torch.Tensor</em>) – Single-point marginals of the model.</p></li>
<li><p><strong>pij</strong> (<em>torch.Tensor</em>) – Two-points marginals of the model.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
<li><p><strong>nsweeps</strong> (<em>int</em>) – Number of Gibbs steps for each gradient estimation.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – Learning rate.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of gradient updates to be done.</p></li>
<li><p><strong>target_pearson</strong> (<em>float</em>) – Target Pearson coefficient.</p></li>
<li><p><strong>tokens</strong> (<em>str</em><em>, </em><em>optional</em>) – Alphabet to be used for the encoding. Defaults to “protein”.</p></li>
<li><p><strong>check_slope</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to take into account the slope for the convergence criterion or not. Defaults to False.</p></li>
<li><p><strong>file_paths</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>, </em><em>optional</em>) – Dictionary containing the paths where to save log, params, and chains.  Defaults to None.</p></li>
<li><p><strong>progress_bar</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display a progress bar or not. Defaults to True.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to be used. Defaults to “cpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated chains and parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, Dict[str, torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.grad.update">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.grad.</span></span><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsweeps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.grad.update" title="Link to this definition">¶</a></dt>
<dd><p>Updates the parameters of the model and the Markov chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampler</strong> (<em>Callable</em>) – Sampling function.</p></li>
<li><p><strong>chains</strong> (<em>torch.Tensor</em>) – Markov chains simulated with the model.</p></li>
<li><p><strong>fi</strong> (<em>torch.Tensor</em>) – Single-point frequencies of the data.</p></li>
<li><p><strong>fij</strong> (<em>torch.Tensor</em>) – Two-points frequencies of the data.</p></li>
<li><p><strong>pi</strong> (<em>torch.Tensor</em>) – Single-point marginals of the model.</p></li>
<li><p><strong>pij</strong> (<em>torch.Tensor</em>) – Two-points marginals of the model.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em>) – Mask of the interaction graph.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – Learning rate.</p></li>
<li><p><strong>nsweeps</strong> (<em>int</em>) – Number of Monte Carlo updates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated chains and parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, Dict[str, torch.Tensor]]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-adabmDCA.io">
<span id="adabmdca-io-module"></span><h2>adabmDCA.io module<a class="headerlink" href="#module-adabmDCA.io" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.io.load_chains">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.io.</span></span><span class="sig-name descname"><span class="pre">load_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.io.load_chains" title="Link to this definition">¶</a></dt>
<dd><p>Loads the sequences from a fasta file and returns the numeric-encoded version.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Path to the file containing the sequences.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – “protein”, “dna”, “rna” or another string with the alphabet to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numeric-encoded sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.io.load_params">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.io.</span></span><span class="sig-name descname"><span class="pre">load_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.io.load_params" title="Link to this definition">¶</a></dt>
<dd><p>Import the parameters of the model from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Path of the file that stores the parameters.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – “protein”, “dna”, “rna” or another string with the alphabet to be used.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Device where to store the parameters.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – Data type of the parameters. Defaults to torch.float32.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.io.load_params_oldformat">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.io.</span></span><span class="sig-name descname"><span class="pre">load_params_oldformat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.io.load_params_oldformat" title="Link to this definition">¶</a></dt>
<dd><p>Import the parameters of the model from a file. Assumes the old DCA format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Path of the file that stores the parameters.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Device where to store the parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.io.save_chains">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.io.</span></span><span class="sig-name descname"><span class="pre">save_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.io.save_chains" title="Link to this definition">¶</a></dt>
<dd><p>Saves the chains in a fasta file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Path to the file where to save the chains.</p></li>
<li><p><strong>chains</strong> (<em>torch.Tensor</em>) – Chains.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – “protein”, “dna”, “rna” or another string with the alphabet to be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.io.save_params">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.io.</span></span><span class="sig-name descname"><span class="pre">save_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#adabmDCA.io.save_params" title="Link to this definition">¶</a></dt>
<dd><p>Saves the parameters of the model in a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Path to the file where to save the parameters.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em>) – Mask of the coupling matrix that determines which are the non-zero entries.</p></li>
<li><p><strong>tokens</strong> (<em>str</em>) – “protein”, “dna”, “rna” or another string with the alphabet to be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.io.save_params_oldformat">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.io.</span></span><span class="sig-name descname"><span class="pre">save_params_oldformat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#adabmDCA.io.save_params_oldformat" title="Link to this definition">¶</a></dt>
<dd><p>Saves the parameters of the model in a file. Assumes the old DCA format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Path to the file where to save the parameters.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em>) – Mask of the coupling matrix that determines which are the non-zero entries.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-adabmDCA.methods">
<span id="adabmdca-methods-module"></span><h2>adabmDCA.methods module<a class="headerlink" href="#module-adabmDCA.methods" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.methods.compute_energy">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.methods.</span></span><span class="sig-name descname"><span class="pre">compute_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.methods.compute_energy" title="Link to this definition">¶</a></dt>
<dd><p>Compute the DCA energy of the sequences in X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – Sequences in one-hot encoding format.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DCA Energy of the sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.methods.get_mask_save">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.methods.</span></span><span class="sig-name descname"><span class="pre">get_mask_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.methods.get_mask_save" title="Link to this definition">¶</a></dt>
<dd><p>Returns the mask to save the upper-triangular part of the coupling matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> (<em>int</em>) – Length of the MSA.</p></li>
<li><p><strong>q</strong> (<em>int</em>) – Number of values that each residue can assume.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Device where to store the mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.methods.init_chains">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.methods.</span></span><span class="sig-name descname"><span class="pre">init_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.methods.init_chains" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the chains of the DCA model. If ‘fi’ is provided, the chains are sampled from the
profile model, otherwise they are sampled uniformly at random.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_chains</strong> (<em>int</em>) – Number of parallel chains.</p></li>
<li><p><strong>L</strong> (<em>int</em>) – Length of the MSA.</p></li>
<li><p><strong>q</strong> (<em>int</em>) – Number of values that each residue can assume.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Device where to store the chains.</p></li>
<li><p><strong>fi</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Single-point frequencies. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initialized parallel chains in one-hot encoding format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.methods.init_parameters">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.methods.</span></span><span class="sig-name descname"><span class="pre">init_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.methods.init_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the parameters of the DCA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fi</strong> (<em>torch.Tensor</em>) – Single-point frequencies of the data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.methods.set_zerosum_gauge">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.methods.</span></span><span class="sig-name descname"><span class="pre">set_zerosum_gauge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.methods.set_zerosum_gauge" title="Link to this definition">¶</a></dt>
<dd><p>Sets the zero-sum gauge on the coupling matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters with fixed gauge.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-adabmDCA.parser">
<span id="adabmdca-parser-module"></span><h2>adabmDCA.parser module<a class="headerlink" href="#module-adabmDCA.parser" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.parser.add_args_dca">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.parser.</span></span><span class="sig-name descname"><span class="pre">add_args_dca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArgumentParser</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArgumentParser</span></span></span><a class="headerlink" href="#adabmDCA.parser.add_args_dca" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.parser.add_args_eaDCA">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.parser.</span></span><span class="sig-name descname"><span class="pre">add_args_eaDCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArgumentParser</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArgumentParser</span></span></span><a class="headerlink" href="#adabmDCA.parser.add_args_eaDCA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.parser.add_args_edDCA">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.parser.</span></span><span class="sig-name descname"><span class="pre">add_args_edDCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArgumentParser</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ArgumentParser</span></span></span><a class="headerlink" href="#adabmDCA.parser.add_args_edDCA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-adabmDCA.plot">
<span id="adabmdca-plot-module"></span><h2>adabmDCA.plot module<a class="headerlink" href="#module-adabmDCA.plot" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.plot.plot_PCA">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.plot.</span></span><span class="sig-name descname"><span class="pre">plot_PCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">figure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.plot.plot_PCA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.plot.plot_autocorrelation">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.plot.</span></span><span class="sig-name descname"><span class="pre">plot_autocorrelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocorr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_seqid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seqid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.plot.plot_autocorrelation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.plot.plot_hist">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.plot.</span></span><span class="sig-name descname"><span class="pre">plot_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vertical'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.plot.plot_hist" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.plot.plot_pearson_sampling">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.plot.</span></span><span class="sig-name descname"><span class="pre">plot_pearson_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pearsons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pearson_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.plot.plot_pearson_sampling" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.plot.plot_scatter_correlations">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.plot.</span></span><span class="sig-name descname"><span class="pre">plot_scatter_correlations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cij_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cij_gen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cijk_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cijk_gen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pearson_Cij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pearson_Cijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="headerlink" href="#adabmDCA.plot.plot_scatter_correlations" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.plot.plot_scatter_labels">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.plot.</span></span><span class="sig-name descname"><span class="pre">plot_scatter_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.plot.plot_scatter_labels" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-adabmDCA.resampling">
<span id="adabmdca-resampling-module"></span><h2>adabmDCA.resampling module<a class="headerlink" href="#module-adabmDCA.resampling" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.resampling.compute_mixing_time">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.resampling.</span></span><span class="sig-name descname"><span class="pre">compute_mixing_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_sweeps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.resampling.compute_mixing_time" title="Link to this definition">¶</a></dt>
<dd><p>Computes the mixing time using the t and t/2 method. The sampling will halt when the mixing time is reached or
the limit of <cite>n_max_sweeps</cite> sweeps is reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampler</strong> (<em>Callable</em>) – Sampling function.</p></li>
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Initial data.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters for the sampling.</p></li>
<li><p><strong>n_max_sweeps</strong> (<em>int</em>) – Maximum number of sweeps.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Inverse temperature for the sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Results of the mixing time analysis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, list]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-adabmDCA.sampling">
<span id="adabmdca-sampling-module"></span><h2>adabmDCA.sampling module<a class="headerlink" href="#module-adabmDCA.sampling" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.sampling.get_deltaE">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.sampling.</span></span><span class="sig-name descname"><span class="pre">get_deltaE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#adabmDCA.sampling.get_deltaE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.sampling.get_sampler">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.sampling.</span></span><span class="sig-name descname"><span class="pre">get_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="headerlink" href="#adabmDCA.sampling.get_sampler" title="Link to this definition">¶</a></dt>
<dd><p>Returns the sampling function corresponding to the chosen method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sampling_method</strong> (<em>str</em>) – String indicating the sampling method. Choose between ‘metropolis’ and ‘gibbs’.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – Unknown sampling method.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sampling function.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.sampling.gibbs_sampling">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.sampling.</span></span><span class="sig-name descname"><span class="pre">gibbs_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsweeps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.sampling.gibbs_sampling" title="Link to this definition">¶</a></dt>
<dd><p>Gibbs sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chains</strong> (<em>torch.Tensor</em>) – Initial chains.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
<li><p><strong>nsweeps</strong> (<em>int</em>) – Number of sweeps.</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Inverse temperature. Defaults to 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated chains.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.sampling.metropolis">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.sampling.</span></span><span class="sig-name descname"><span class="pre">metropolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsweeps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.sampling.metropolis" title="Link to this definition">¶</a></dt>
<dd><p>Metropolis sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chains</strong> (<em>torch.Tensor</em>) – One-hot encoded sequences.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
<li><p><strong>nsweeps</strong> (<em>int</em>) – Number of sweeps to be performed.</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Inverse temperature. Defaults to 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated chains.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.sampling.metropolis_sweep">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.sampling.</span></span><span class="sig-name descname"><span class="pre">metropolis_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.sampling.metropolis_sweep" title="Link to this definition">¶</a></dt>
<dd><p>Performs a Metropolis sweep over the chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chains</strong> (<em>torch.Tensor</em>) – One-hot encoded sequences.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Parameters of the model.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Inverse temperature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated chains.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-adabmDCA.stats">
<span id="adabmdca-stats-module"></span><h2>adabmDCA.stats module<a class="headerlink" href="#module-adabmDCA.stats" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.extract_Cij_from_freq">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">extract_Cij_from_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.stats.extract_Cij_from_freq" title="Link to this definition">¶</a></dt>
<dd><p>Extracts the lower triangular part of the covariance matrices of the data and chains starting from the frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fij</strong> (<em>torch.Tensor</em>) – Two-point frequencies of the data.</p></li>
<li><p><strong>pij</strong> (<em>torch.Tensor</em>) – Two-point frequencies of the chains.</p></li>
<li><p><strong>fi</strong> (<em>torch.Tensor</em>) – Single-point frequencies of the data.</p></li>
<li><p><strong>pi</strong> (<em>torch.Tensor</em>) – Single-point frequencies of the chains.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Mask for comparing just a subset of the couplings. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted two-point frequencies of the data and chains.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.extract_Cij_from_seqs">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">extract_Cij_from_seqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.stats.extract_Cij_from_seqs" title="Link to this definition">¶</a></dt>
<dd><p>Extracts the lower triangular part of the covariance matrices of the data and chains starting from the sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Data sequences.</p></li>
<li><p><strong>chains</strong> (<em>torch.Tensor</em>) – Chain sequences.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Mask for comparing just a subset of the couplings. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-point frequencies of the data and chains.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.generate_unique_triplets">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">generate_unique_triplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.stats.generate_unique_triplets" title="Link to this definition">¶</a></dt>
<dd><p>Generates a set of unique triplets of positions. Used to compute the 3-points statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> (<em>int</em>) – Length of the sequences.</p></li>
<li><p><strong>ntriplets</strong> (<em>int</em>) – Number of triplets to be generated.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to perform computations on. Defaults to “cpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape (ntriplets, 3) containing the indices of the triplets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.get_correlation_two_points">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">get_correlation_two_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#adabmDCA.stats.get_correlation_two_points" title="Link to this definition">¶</a></dt>
<dd><p>Computes the Pearson coefficient and the slope between the two-point frequencies of data and chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fij</strong> (<em>torch.Tensor</em>) – Two-point frequencies of the data.</p></li>
<li><p><strong>pij</strong> (<em>torch.Tensor</em>) – Two-point frequencies of the chains.</p></li>
<li><p><strong>fi</strong> (<em>torch.Tensor</em>) – Single-point frequencies of the data.</p></li>
<li><p><strong>pi</strong> (<em>torch.Tensor</em>) – Single-point frequencies of the chains.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Mask to select the couplings to use for the correlation coefficient. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pearson correlation coefficient of the two-sites statistics and slope of the interpolating line.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.get_covariance_matrix">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">get_covariance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.stats.get_covariance_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Computes the weighted covariance matrix of the input multi sequence alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input MSA in one-hot variables.</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – Importance weights of the sequences.</p></li>
<li><p><strong>pseudo_count</strong> (<em>float</em><em>, </em><em>optional</em>) – Pseudo count. Defaults to 0..</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Covariance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.get_freq_three_points">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">get_freq_three_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntriplets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.stats.get_freq_three_points" title="Link to this definition">¶</a></dt>
<dd><p>Computes the 3-body statistics of the input MSA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input MSA in one-hot encoding.</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – Importance weights for the sequences.</p></li>
<li><p><strong>ntriplets</strong> (<em>int</em>) – Number of triplets to test.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to perform computations on. Defaults to “cpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-points connected correlation for ntriplets randomly extracted triplets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.get_slope">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">get_slope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#adabmDCA.stats.get_slope" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="adabmDCA.stats.resample_sequences">
<span class="sig-prename descclassname"><span class="pre">adabmDCA.stats.</span></span><span class="sig-name descname"><span class="pre">resample_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nextract</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#adabmDCA.stats.resample_sequences" title="Link to this definition">¶</a></dt>
<dd><p>Extracts nextract sequences from data with replacement according to the weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Data array.</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – Weights of the sequences.</p></li>
<li><p><strong>nextract</strong> (<em>int</em>) – Number of sequences to be extracted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-adabmDCA">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-adabmDCA" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">adabmDCApy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">adabmDCA package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.custom_fn">adabmDCA.custom_fn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.dataset">adabmDCA.dataset module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.dataset.DatasetDCA"><code class="docutils literal notranslate"><span class="pre">DatasetDCA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adabmDCA.dataset.DatasetDCA.get_effective_size"><code class="docutils literal notranslate"><span class="pre">DatasetDCA.get_effective_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#adabmDCA.dataset.DatasetDCA.get_num_residues"><code class="docutils literal notranslate"><span class="pre">DatasetDCA.get_num_residues()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#adabmDCA.dataset.DatasetDCA.get_num_states"><code class="docutils literal notranslate"><span class="pre">DatasetDCA.get_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#adabmDCA.dataset.DatasetDCA.shuffle"><code class="docutils literal notranslate"><span class="pre">DatasetDCA.shuffle()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.fasta_utils">adabmDCA.fasta_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.compute_weights"><code class="docutils literal notranslate"><span class="pre">compute_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.decode_sequence"><code class="docutils literal notranslate"><span class="pre">decode_sequence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.encode_sequence"><code class="docutils literal notranslate"><span class="pre">encode_sequence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.get_tokens"><code class="docutils literal notranslate"><span class="pre">get_tokens()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.import_clean_dataset"><code class="docutils literal notranslate"><span class="pre">import_clean_dataset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.import_from_fasta"><code class="docutils literal notranslate"><span class="pre">import_from_fasta()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.validate_alphabet"><code class="docutils literal notranslate"><span class="pre">validate_alphabet()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.fasta_utils.write_fasta"><code class="docutils literal notranslate"><span class="pre">write_fasta()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.grad">adabmDCA.grad module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.grad.train_graph"><code class="docutils literal notranslate"><span class="pre">train_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.grad.update"><code class="docutils literal notranslate"><span class="pre">update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.io">adabmDCA.io module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.io.load_chains"><code class="docutils literal notranslate"><span class="pre">load_chains()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.io.load_params"><code class="docutils literal notranslate"><span class="pre">load_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.io.load_params_oldformat"><code class="docutils literal notranslate"><span class="pre">load_params_oldformat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.io.save_chains"><code class="docutils literal notranslate"><span class="pre">save_chains()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.io.save_params"><code class="docutils literal notranslate"><span class="pre">save_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.io.save_params_oldformat"><code class="docutils literal notranslate"><span class="pre">save_params_oldformat()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.methods">adabmDCA.methods module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.methods.compute_energy"><code class="docutils literal notranslate"><span class="pre">compute_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.methods.get_mask_save"><code class="docutils literal notranslate"><span class="pre">get_mask_save()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.methods.init_chains"><code class="docutils literal notranslate"><span class="pre">init_chains()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.methods.init_parameters"><code class="docutils literal notranslate"><span class="pre">init_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.methods.set_zerosum_gauge"><code class="docutils literal notranslate"><span class="pre">set_zerosum_gauge()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.parser">adabmDCA.parser module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.parser.add_args_dca"><code class="docutils literal notranslate"><span class="pre">add_args_dca()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.parser.add_args_eaDCA"><code class="docutils literal notranslate"><span class="pre">add_args_eaDCA()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.parser.add_args_edDCA"><code class="docutils literal notranslate"><span class="pre">add_args_edDCA()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.plot">adabmDCA.plot module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.plot.plot_PCA"><code class="docutils literal notranslate"><span class="pre">plot_PCA()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.plot.plot_autocorrelation"><code class="docutils literal notranslate"><span class="pre">plot_autocorrelation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.plot.plot_hist"><code class="docutils literal notranslate"><span class="pre">plot_hist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.plot.plot_pearson_sampling"><code class="docutils literal notranslate"><span class="pre">plot_pearson_sampling()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.plot.plot_scatter_correlations"><code class="docutils literal notranslate"><span class="pre">plot_scatter_correlations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.plot.plot_scatter_labels"><code class="docutils literal notranslate"><span class="pre">plot_scatter_labels()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.resampling">adabmDCA.resampling module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.resampling.compute_mixing_time"><code class="docutils literal notranslate"><span class="pre">compute_mixing_time()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.sampling">adabmDCA.sampling module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.sampling.get_deltaE"><code class="docutils literal notranslate"><span class="pre">get_deltaE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.sampling.get_sampler"><code class="docutils literal notranslate"><span class="pre">get_sampler()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.sampling.gibbs_sampling"><code class="docutils literal notranslate"><span class="pre">gibbs_sampling()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.sampling.metropolis"><code class="docutils literal notranslate"><span class="pre">metropolis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.sampling.metropolis_sweep"><code class="docutils literal notranslate"><span class="pre">metropolis_sweep()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA.stats">adabmDCA.stats module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.extract_Cij_from_freq"><code class="docutils literal notranslate"><span class="pre">extract_Cij_from_freq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.extract_Cij_from_seqs"><code class="docutils literal notranslate"><span class="pre">extract_Cij_from_seqs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.generate_unique_triplets"><code class="docutils literal notranslate"><span class="pre">generate_unique_triplets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.get_correlation_two_points"><code class="docutils literal notranslate"><span class="pre">get_correlation_two_points()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.get_covariance_matrix"><code class="docutils literal notranslate"><span class="pre">get_covariance_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.get_freq_three_points"><code class="docutils literal notranslate"><span class="pre">get_freq_three_points()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.get_slope"><code class="docutils literal notranslate"><span class="pre">get_slope()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adabmDCA.stats.resample_sequences"><code class="docutils literal notranslate"><span class="pre">resample_sequences()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-adabmDCA">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">adabmDCApy documentation</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Lorenzo Rosset.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/adabmDCA.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>